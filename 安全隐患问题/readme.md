# 一、简述
网站安全是指出于防止网站受到外来电脑入侵者对其网站进行挂马，篡改网页等行为而做出一系列的防御工作。由于一个网站设计者更多地考虑满足用户应用，如何实现业务。
很少考虑网站应用开发过程中所存在的漏洞，这些漏洞在不关注安全代码设计的人员眼里几乎不可见，大多数网站设计开发者、网站维护人员对网站攻防技术的了解甚少；在正常使用过程中，即便存在安全漏洞，正常的使用者并不会察觉。
攻击手段主要是利用Web服务器的漏洞攻击和网页漏洞攻击。


# 一、HTTPS和HTTP协议
早在2014年，由网际网路安全研究组织Internet Security Research Group(ISRG)负责营运的 “Let’s Encrypt”项目就成立了，意在推动全球网站的全面HTTPS化。
更安全、更可信，是HTTP后面这个“S”最大的意义。HTTPS在HTTP的基础上加入了SSL/TLS协议，依靠SSL证书来验证服务器的身份，并为客户端和服务器端之间建立“SSL加密通道”，确保用户数据在传输过程中处于加密状态，同时防止服务器被钓鱼网站假冒。
## HTTP存在的缺陷：
HTTP明文协议的缺陷，是导致数据泄露、数据篡改、流量劫持、钓鱼攻击等安全问题的重要原因。HTTP协议无法加密数据，所有通信数据都在网络中明文“裸奔”。通过网络的嗅探设备及一些技术手段，就可还原HTTP报文内容。


即使是技术强悍的知名互联网企业，在每天数十亿次的数据请求中，都不可避免地会有小部分流量遭到劫持或篡改，更不要提其它的小微网站了。


# HTTPS优势

加密从客户端出来就已经是密文数据了，那么你的用户在任何网络链路上接入，即使被监听，黑客截获的数据都是密文数据，无法在现有条件下还原出原始数据信息。


谷歌早在2014年就宣布，将把HTTPS作为影响搜索排名的重要因素，并优先索引HTTPS网页。百度也公告表明，开放收录HTTPS站点，同一个域名的http版和https版为一个站点，优先收录https版。

只有部分网页可不够，全站HTTPS才是最佳方案
很多网站所有者认为，只有登录页面和交易页面才需要HTTPS保护，而事实上，全站HTTPS化才是确保所有用户数据安全可靠加密传输的最佳方案。局部部署HTTPS，在HTTP跳转或重定向到HTTPS的过程中，仍然存在受到劫持的风险[1]。

情况一：从HTTP页面跳转访问HTTPS页面

情况二：HTTP页面重定向到HTTPS页面

# PHP相关的安全问题
一. SQL注进式攻击

1 sql注入

2 用户输进的类型（表单的文本框输入限制）

二. 设置网站文件所有者防止php网站被挂木马

根据生产环境不断反馈，发现不断有php网站被挂木马，绝大部分原因是因为权限设置不合理造成。因为服务器软件，或是php程序中存在漏洞都是难免的，在这种情况下，如果能正确设置Linux网站目录权限，php进程权限，那么网站的安全性实际上是可以得到保障的。
造成网站被挂木马的原因是什么？
1. 　ftp 连接信息被破解
2. 　网站服务器软件，程序存在漏洞被利用。
相关链接[https://www.jianshu.com/p/ed6491169b24](https://www.php1.cn/detail/ZhengQueSheZhiWangZhanWenJianSuoYouZheFangZhi_php_WangZhanBeiGuaMuMa.html)

文件及进程权限
php-fpm/apache/nginx 等进程对网站文件至少需要有读取权限	
![](http://s7.51cto.com/wyfs01/M00/0E/C6/wKioJlGurbSAbfp8AACTy1jz-uE204.jpg)

![](http://s6.51cto.com/wyfs01/M00/0E/C8/wKioOVGurbWhNbwBAAEVuJZgWOM720.jpg)

◆ nginx和 php 对网站只有读取权限，无写入权限


◆ 如果php 程序需要对网站某些文件有写入权限，需要手工将文件或目录权限修改为 777


可以想象的是，万一 php 
程序中有漏洞，攻击者上传木马，便可以修改网站的所有文件，网站首页被黑，也就不足为怪了。


退一步，如果我们设置了较严格的权限，就算php 程序中存在漏洞，那么攻击者也只能篡改权限为 777 
的目录，其它的文件是无法被改写的，网站不就就得更安全了吗？

核心总结：php-fpm/apache/nginx进程所使用的用户，不能是网站文件所有者。 凡是违背这个原则，则不符合最小权限原则。

# 如何防范SQL注入、CSRF、XSS攻击？

1、使用PDO预处理的方式，也就是一个萝卜一个坑。
预处理。将输入的数值，绑定到参数，也就是放进坑里（一个萝卜一个坑，一个参数一个坑），这样输入的内容（外部的内容）就都落到坑里了，在每个坑里处理每个参数，这样就安全了，不会出现SQL注入。


2、使用htmlspecialchars()等函数进行转义。还可以对输入类型进行检测，类型转换。


二：如何防范CSRF攻击


使用token进行验证。可以在 HTTP 请求中以参数的形式加入一个随机产生的 token，并在服务器端建立一个拦截器来验证这个 token，如果请求中没有 token 或者 token 内容不正确，则认为可能是 CSRF 攻击而拒绝该请求。（使用GET或POST方法加TOKEN）

laravel（csrf_token）


三 如何防范XSS攻击
1、案例：听以前在阿里的同事分享：之前淘宝有一个意见反馈功能，有一天后台人员查看用户提交的意见，打开的某一条意见的瞬间，自动跳转到了另一个网站。但当时幸亏是阿里内网，对外网做了限制，没有造成危害。可见，XSS不可小觑。


2、防范：最简单的办法，过滤输入。对用户的输入，可以使用htmlspecialchars()等函数进行过滤转义，当然，一些文件上传等，也可能会造成此攻击，要限制上传文件的类型，比如只能传图片等。
